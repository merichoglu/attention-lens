using device: cpu
vocab size: 15
loaded 20000 samples from data/train.txt
loaded 2000 samples from data/val.txt

model parameters: 598,671

epoch 1/10
  batch 100/313, loss: 1.6232, acc: 42.78%, tf_ratio: 1.00
  batch 200/313, loss: 1.5095, acc: 46.21%, tf_ratio: 1.00
  batch 300/313, loss: 1.4912, acc: 46.77%, tf_ratio: 1.00
train loss: 1.5958, train acc: 44.71%
val loss: 1.4403, val acc: 46.74%
saved best model with val loss: 1.4403, val acc: 46.74%

epoch 2/10
  batch 100/313, loss: 1.4148, acc: 50.00%, tf_ratio: 0.95
  batch 200/313, loss: 1.4153, acc: 48.13%, tf_ratio: 0.95
  batch 300/313, loss: 1.4695, acc: 46.87%, tf_ratio: 0.95
train loss: 1.4225, train acc: 47.20%
val loss: 1.3381, val acc: 50.07%
saved best model with val loss: 1.3381, val acc: 50.07%

epoch 3/10
  batch 100/313, loss: 1.3740, acc: 48.30%, tf_ratio: 0.90
  batch 200/313, loss: 1.3266, acc: 49.24%, tf_ratio: 0.90
  batch 300/313, loss: 1.2438, acc: 52.02%, tf_ratio: 0.90
train loss: 1.3437, train acc: 49.73%
val loss: 1.1831, val acc: 54.88%
saved best model with val loss: 1.1831, val acc: 54.88%

epoch 4/10
  batch 100/313, loss: 1.2556, acc: 52.65%, tf_ratio: 0.85
  batch 200/313, loss: 1.2290, acc: 53.59%, tf_ratio: 0.85
  batch 300/313, loss: 1.2127, acc: 54.30%, tf_ratio: 0.85
train loss: 1.2285, train acc: 53.50%
val loss: 1.0757, val acc: 60.38%
saved best model with val loss: 1.0757, val acc: 60.38%

epoch 5/10
  batch 100/313, loss: 1.1736, acc: 55.32%, tf_ratio: 0.80
  batch 200/313, loss: 1.1515, acc: 55.31%, tf_ratio: 0.80
  batch 300/313, loss: 1.0936, acc: 58.41%, tf_ratio: 0.80
train loss: 1.1525, train acc: 56.55%
val loss: 1.0056, val acc: 63.40%
saved best model with val loss: 1.0056, val acc: 63.40%

epoch 6/10
  batch 100/313, loss: 1.0781, acc: 59.03%, tf_ratio: 0.75
  batch 200/313, loss: 1.1424, acc: 56.82%, tf_ratio: 0.75
  batch 300/313, loss: 1.0758, acc: 59.70%, tf_ratio: 0.75
train loss: 1.0939, train acc: 58.95%
val loss: 0.9626, val acc: 64.32%
saved best model with val loss: 0.9626, val acc: 64.32%

epoch 7/10
  batch 100/313, loss: 1.0378, acc: 61.41%, tf_ratio: 0.70
  batch 200/313, loss: 1.1043, acc: 58.59%, tf_ratio: 0.70
  batch 300/313, loss: 1.0408, acc: 61.75%, tf_ratio: 0.70
train loss: 1.0510, train acc: 60.74%
val loss: 0.9361, val acc: 65.28%
saved best model with val loss: 0.9361, val acc: 65.28%

epoch 8/10
  batch 100/313, loss: 1.0126, acc: 61.27%, tf_ratio: 0.65
  batch 200/313, loss: 0.9956, acc: 63.33%, tf_ratio: 0.65
  batch 300/313, loss: 0.9838, acc: 64.49%, tf_ratio: 0.65
train loss: 1.0295, train acc: 61.65%
val loss: 0.9206, val acc: 65.89%
saved best model with val loss: 0.9206, val acc: 65.89%

epoch 9/10
  batch 100/313, loss: 1.0442, acc: 60.71%, tf_ratio: 0.60
  batch 200/313, loss: 1.0249, acc: 62.95%, tf_ratio: 0.60
  batch 300/313, loss: 1.0057, acc: 63.33%, tf_ratio: 0.60
train loss: 1.0127, train acc: 62.29%
val loss: 0.9166, val acc: 65.62%
saved best model with val loss: 0.9166, val acc: 65.62%

epoch 10/10
  batch 100/313, loss: 0.9512, acc: 64.01%, tf_ratio: 0.55
  batch 200/313, loss: 1.0014, acc: 63.43%, tf_ratio: 0.55
  batch 300/313, loss: 0.9620, acc: 65.84%, tf_ratio: 0.55
train loss: 0.9911, train acc: 63.17%
val loss: 0.8977, val acc: 66.41%
saved best model with val loss: 0.8977, val acc: 66.41%
